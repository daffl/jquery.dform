(function(a){function h(b,d,f){if(typeof d=="string"){a.isArray(b[d])||(b[d]=[]);b[d].push(f)}else typeof d=="object"&&a.each(d,function(g,i){h(b,g,i)})}var c={},e={};a.fn.extend({runSubscription:function(b,d,f){var g=a(this);a.dform.hasSubscription(b)&&a.each(c[b],function(i,j){j.call(g,d,f)});return a(this)},runAll:function(b){var d=b.type,f=a(this);a(this).runSubscription("[pre]",b,d);a.each(b,function(g,i){a(f).runSubscription(g,i,d)});a(this).runSubscription("[post]",b,d);return a(this)},formElement:function(b){var d=
a.dform.createElement(b);a(this).append(a(d));a(d).runAll(b);return a(this)},buildForm:function(b){if(typeof b=="string"){var d=this;a.get(b,data,function(f){a(d).buildForm(f)},"json")}else if(a(this).is("form")){b=a.extend({type:"form"},b);a(this).attr(a.dform.htmlAttributes(b));a(this).runAll(b)}else a(this).formElement(b)}});a.extend(a,{keyset:function(b){var d=[];a.each(b,function(f){d.push(f)});return d},withKeys:function(b,d){var f={};a.each(d,function(g,i){if(b[i])f[i]=b[i]});return f},withoutKeys:function(b,
d){var f={};a.each(b,function(g,i){if(a.inArray(g,d)==-1)f[g]=i});return f}});a.dform={options:{prefix:"ui-dform-",defaultType:function(b){var d=a.dform.htmlAttributes(b);return a("<"+b.type+">").attr(d)}},htmlAttributes:function(b,d){var f=a.keyset(c);a.isArray(d)&&a.merge(f,d);return a.withoutKeys(b,f)},removeType:function(b){delete e[b]},typeNames:function(){return a.keyset(e)},addType:function(b,d){h(e,b,d)},addTypeIf:function(b,d,f){b&&a.dform.addType(d,f)},subscriberNames:function(){return a.keyset(c)},
subscribe:function(b,d){h(c,b,d)},subscribeIf:function(b,d,f){b&&a.dform.subscribe(d,f)},removeSubscription:function(b){delete c[b]},hasSubscription:function(b){return c[b]?true:false},createElement:function(b){var d=b.type;if(!d)throw"No element type given! Must always exist.";var f=null;if(e[d]){var g=a.withoutKeys(b,"type");a.each(e[d],function(i,j){f=j.call(f,g)})}else f=a.dform.options.defaultType(b);return a(f)}}})(jQuery);
(function(a){function h(c,e,b){return function(d){d=a.dform.htmlAttributes(d,b);return a(c).attr(a.extend(d,e))}}a.dform.addType({text:h("<input>",{type:"text"}),password:h("<input>",{type:"password"}),submit:h("<input>",{type:"submit"}),hidden:h("<input>",{type:"hidden"}),radio:h("<input>",{type:"radio"}),checkbox:h("<input>",{type:"checkbox"}),checkboxes:h("<div>",{},["name"]),radiobuttons:h("<div>",{},["name"]),container:h("<div>",{}),file:h("<input>",{type:"file"})});a.dform.subscribe({"class":function(c){a(this).addClass(c)},
html:function(c){a(this).html(c)},elements:function(c){var e=a(this);a.each(c,function(b,d){if(typeof b=="string")d.name=name;a(e).formElement(d)})},value:function(c){a(this).val(c)},options:function(c,e){var b=a(this);if(e=="select")a.each(c,function(d,f){var g;if(typeof f=="string")g=a("<option>").attr("value",d).html(f);if(typeof f=="object")g=h("<option>",{})(a.withoutKeys(f,["value"])).html(f.value);a(b).append(g)});else if(e=="checkboxes"||e=="radiobuttons"){b=this;a.each(c,function(d,f){var g=
e=="radiobuttons"?{type:"radio"}:{type:"checkbox"};if(typeof f=="string")g.caption=f;else a.extend(g,f);g.value=d;a(b).formElement(g)})}},placeholder:function(c,e){if(e=="text"||e=="textarea"){var b=this;a(this).data("placeholder",c);a(this).val(c);a(this).focus(function(){a(this).val()==a(this).data("placeholder")&&a(this).val("")});a(this).blur(function(){a(this).val()==""&&a(this).val(a(this).data("placeholder"))});a(this).parents("form").submit(function(){a(b).val()==a(b).data("placeholder")&&
a(b).val("")})}},caption:function(c,e){if(e=="fieldset"){var b=a("<legend>").html(c);a(this).prepend(b)}else{b={type:"label"};if(typeof c=="string")b.html=c;else a.extend(b,c);if(a(this).attr("id"))b["for"]=a(this).attr("id");var d=a.dform.createElement(b);if(e=="checkbox"||e=="radio"){a.dform.options.prefix&&a(d).addClass(a.dform.options.prefix+e);a(this).parent().append(a(d))}else a(d).insertBefore(a(this));a(d).runAll(b)}},type:function(c,e){a.dform.options.prefix&&a(this).addClass(a.dform.options.prefix+
e)},"[post]":function(c,e){if(e=="checkboxes"||e=="radiobuttons"){var b=e=="checkboxes"?"checkbox":"radio";a(this).children("[type="+b+"]").each(function(){a(this).attr("name",c.name)})}}})})(jQuery);
(function(a){function h(c,e){var b=a.keyset(a.ui[c].prototype.options);return{options:a.withKeys(e,b),attributes:a.dform.htmlAttributes(e,b)}}a.dform.addTypeIf(a.isFunction(a.fn.progressbar),"progressbar",function(c){c=h("progressbar",c);return a("<div>").attr(c.attributes).progressbar(c.options)});a.dform.addTypeIf(a.isFunction(a.fn.slider),"slider",function(c){c=h("slider",c);return a("<div>").attr(c.attributes).slider(c.options)});a.dform.addTypeIf(a.isFunction(a.fn.accordion),"accordion",function(c){c=
h("accordion",c);return a("<div>").attr(c.attributes)});a.dform.addTypeIf(a.isFunction(a.fn.tabs),"tabs",function(c){c=h("tabs",c);return a("<div>").attr(c.attributes)});a.dform.subscribeIf(a.isFunction(a.fn.accordion),"entries",function(c,e){var b=this;e=="accordion"&&a.each(c,function(d,f){a.extend(f,{type:"container"});a(b).formElement(f);a(b).children("div:last").prev().wrapInner(a("<a>").attr("href","#"))})});a.dform.subscribeIf(a.isFunction(a.fn.tabs),"entries",function(c,e){var b=this;if(e==
"tabs"){a(this).append("<ul>");var d=a(b).children("ul:first");a.each(c,function(f,g){var i=g.id?g.id:f;a.extend(g,{type:"container",id:i});a(b).formElement(g);var j=a(b).children("div:last").prev();a(j).wrapInner(a("<a>").attr("href","#"+i));a(d).append(a("<li>").wrapInner(j))})}});a.dform.subscribeIf(a.isFunction(a.fn.dialog),"dialog",function(c,e){if(e=="form"||e=="fieldset")a(this).dialog(c)});a.dform.subscribeIf(a.isFunction(a.fn.resizable),"resizable",function(c){a(this).resizable(c)});a.dform.subscribeIf(a.isFunction(a.fn.datepicker),
"datepicker",function(c,e){e=="text"&&a(this).datepicker(c)});a.dform.subscribeIf(a.isFunction(a.fn.autocomplete),"autocomplete",function(c,e){e=="text"&&a(this).autocomplete(c)});a.dform.subscribe("[post]",function(c,e){if(a(this).parents("form").hasClass("ui-widget")){if((e=="button"||e=="submit")&&a.isFunction(a.fn.button))a(this).button();a.inArray(e,["text","textarea","password","fieldset"])!=-1&&a(this).addClass("ui-widget-content ui-corner-all")}if(e=="accordion"){var b=h(e,c).options;a.extend(b,
{header:"label"});a(this).accordion(b)}else if(e=="tabs"){b=h(e,c).options;a(this).tabs(b)}});a.dform.subscribeIf(a.isFunction(a.fn.validate),{"[pre]":function(c,e){if(e=="form"){var b={};if(a(this).hasClass("ui-widget"))b={highlight:function(d){a(d).addClass("ui-state-highlight")},unhighlight:function(d){a(d).removeClass("ui-state-highlight")}};a(this).validate(b)}},validate:function(c){a(this).rules("add",c)}});a.dform.subscribeIf(a.isFunction(a.fn.ajaxForm),"ajax",function(c,e){e=="form"&&a(this).ajaxForm(c)});
a.dform.subscribeIf(a.isFunction(a.fn.wysiwyg),"wysiwyg",function(){})})(jQuery);
